# ğŸ§© Problem #1792 â€“ Maximum Average Pass Ratio

**Difficulty:** Medium  
**Topics:** `Greedy`, `Heap`  
**Link:** [Leetcode Problem](https://leetcode.com/problems/maximum-average-pass-ratio/)

---

## ğŸ“ Problem
We have several classes, each with `PASSi` students passing out of `TOTALi`.  
We can assign `extraStudents` additional brilliant students (who always pass).  

Our goal â†’ distribute these students to maximize the **average pass ratio** across all classes.  

**Pass ratio of a class:**   `ratio= pass/total`

**Average pass ratio:**  `average = âˆ‘ratio/n`

---

## ğŸš€ Intuition

Key observation:  
- Assigning an extra student increases ratio differently for each class.  
- For a class `[pass, total]`, the **gain** from adding one student is:

`Î” = ((pass+1)/(total+1)) - (pass/total)`

We always want to assign the next student to the class with **maximum Î”**.  
This screams **Greedy + Max Heap**.  

---

## ğŸ”‘ Approach
1. For each class, compute its Î” (gain) and push into a **max-heap**.  
2. While we have extra students:
   - Pop the class with the **largest Î”**.  
   - Assign one student (update `pass`, `total`).  
   - Recompute Î” and push back.  
3. After all students are assigned, compute final average.  

---

## â±ï¸ Complexity
- Building heap: `O(N log N)`  
- Assigning students: `O(M log N)` where `M = extraStudents`  
- Final average: `O(N)`  

Overall: `O((N + M)/log N)`

This is efficient for constraints (`10^5`).  

---

## ğŸ’» Implementation (JavaScript)

```javascript []
var maxAverageRatio = function(classes, extraStudents) {
    const maxHeap = new MaxHeap();

    for(const [pass, total] of classes){
        maxHeap.push({
            num: ((pass+1)/(total+1) - pass/total),
            data: {pass, total}
        });
    }

    for(let i=0; i<extraStudents; i++){
        const {data: {pass, total}} = maxHeap.pop();
        const _pass = pass+1, _total = total+1;
        maxHeap.push({
            num: ((_pass+1)/(_total+1) - _pass/_total),
            data: {pass: _pass, total: _total}
        });
    }

    let ans = 0;
    while(!maxHeap.isEmpty()){
        const {data: {pass, total}} = maxHeap.pop();
        ans += (pass/total);
    }

    return ans / classes.length;
};
```
---

## âœ… Example Walkthrough

**Input:**  
```
classes = [[1,2],[3,5],[2,2]], extraStudents = 2
```


- Gains:  
  - `[1,2]`: Î”=0.167  
  - `[3,5]`: Î”=0.083  
  - `[2,2]`: Î”=0.000  

- First student â†’ goes to `[1,2]` â†’ becomes `[2,3]`  
- Recompute Î” for `[2,3]`: 0.083  
- Second student â†’ still best is `[2,3]` â†’ becomes `[3,4]`  

Final ratios = `[3/4, 3/5, 2/2]`  
Average = `(0.75 + 0.6 + 1.0) / 3 = 0.7833`  

---

## ğŸ¯ Takeaway
- Always prioritize the **gain per assignment**, not the raw ratio.  
- Classic **Greedy + Heap** problem.  

