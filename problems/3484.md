# ðŸ§© Problem #3484 - Design Spreadsheet  

**Difficulty:** Medium  
**Tags:** Design, Hash Map 
**Link:** [Leetcode](https://leetcode.com/problems/design-spreadsheet/)  

---

## ðŸ§  Intuition  
We want to design a simplified spreadsheet with **26 columns (Aâ€“Z)** and `rows` rows.  
Each cell can either store:  
- An integer value, or  
- Be empty (treated as `0`).  

Formulas are given in the form `=X+Y`, where `X` and `Y` are either:  
- Cell references (e.g., `A1`, `C12`), or  
- Integer literals (e.g., `5`, `100`).  

Sparse storage using a `Map` is efficient since not all cells will be set.  

---

## ðŸ’¡ Approach â€” HashMap + Formula Parser  

1. Use a `Map<string, number>` where the key is the cell (like `"A1"`) and value is its content.  
2. **setCell(cell, value)** â†’ insert/overwrite in map.  
3. **resetCell(cell)** â†’ delete from map (cell becomes `0`).  
4. **getValue(formula)** â†’ split `=X+Y`, then:  
   - If token is a cell reference: return its stored value or `0` if unset.  
   - If token is a number: parse as integer.  
   - Add the two results.  

---

## âœ… Solution (JavaScript)  

```javascript
class Spreadsheet {
    constructor(rows) {
        this._cells = new Map();
        this._rows = rows;
    }

    setCell(cell, value) {
        this._cells.set(cell, value);
    }

    resetCell(cell) {
        this._cells.delete(cell);
    }

    _handleCell(token) {
        // If starts with letter => cell reference
        if (token.charCodeAt(0) >= 65 && token.charCodeAt(0) <= 90) {
            return this._cells.has(token) ? this._cells.get(token) : 0;
        }
        // Otherwise, parse as integer
        return Number(token);
    }

    getValue(formula) {
        const [cell1, cell2] = formula.substring(1).split("+");
        return this._handleCell(cell1.trim()) + this._handleCell(cell2.trim());
    }
}
```
---

## ðŸ“Š Complexity

- **setCell / resetCell**: `O(1)` average (Map set/delete).
- **getValue**: `O(1)` â€” parsing + two lookups.
- **Space**: `O(k)` where k = number of explicitly set cells.
